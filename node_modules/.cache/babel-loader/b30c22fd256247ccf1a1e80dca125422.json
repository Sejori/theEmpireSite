{"ast":null,"code":"import { MathUtils } from './MathUtils.js';\n\nclass Quaternion {\n  constructor(x = 0, y = 0, z = 0, w = 1) {\n    Object.defineProperty(this, 'isQuaternion', {\n      value: true\n    });\n    this._x = x;\n    this._y = y;\n    this._z = z;\n    this._w = w;\n  }\n\n  static slerp(qa, qb, qm, t) {\n    return qm.copy(qa).slerp(qb, t);\n  }\n\n  static slerpFlat(dst, dstOffset, src0, srcOffset0, src1, srcOffset1, t) {\n    // fuzz-free, array-based Quaternion SLERP operation\n    var x0 = src0[srcOffset0 + 0],\n        y0 = src0[srcOffset0 + 1],\n        z0 = src0[srcOffset0 + 2],\n        w0 = src0[srcOffset0 + 3];\n    var x1 = src1[srcOffset1 + 0],\n        y1 = src1[srcOffset1 + 1],\n        z1 = src1[srcOffset1 + 2],\n        w1 = src1[srcOffset1 + 3];\n\n    if (w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1) {\n      var s = 1 - t;\n      var cos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\n          dir = cos >= 0 ? 1 : -1,\n          sqrSin = 1 - cos * cos; // Skip the Slerp for tiny steps to avoid numeric problems:\n\n      if (sqrSin > Number.EPSILON) {\n        var sin = Math.sqrt(sqrSin),\n            len = Math.atan2(sin, cos * dir);\n        s = Math.sin(s * len) / sin;\n        t = Math.sin(t * len) / sin;\n      }\n\n      var tDir = t * dir;\n      x0 = x0 * s + x1 * tDir;\n      y0 = y0 * s + y1 * tDir;\n      z0 = z0 * s + z1 * tDir;\n      w0 = w0 * s + w1 * tDir; // Normalize in case we just did a lerp:\n\n      if (s === 1 - t) {\n        var f = 1 / Math.sqrt(x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0);\n        x0 *= f;\n        y0 *= f;\n        z0 *= f;\n        w0 *= f;\n      }\n    }\n\n    dst[dstOffset] = x0;\n    dst[dstOffset + 1] = y0;\n    dst[dstOffset + 2] = z0;\n    dst[dstOffset + 3] = w0;\n  }\n\n  static multiplyQuaternionsFlat(dst, dstOffset, src0, srcOffset0, src1, srcOffset1) {\n    var x0 = src0[srcOffset0];\n    var y0 = src0[srcOffset0 + 1];\n    var z0 = src0[srcOffset0 + 2];\n    var w0 = src0[srcOffset0 + 3];\n    var x1 = src1[srcOffset1];\n    var y1 = src1[srcOffset1 + 1];\n    var z1 = src1[srcOffset1 + 2];\n    var w1 = src1[srcOffset1 + 3];\n    dst[dstOffset] = x0 * w1 + w0 * x1 + y0 * z1 - z0 * y1;\n    dst[dstOffset + 1] = y0 * w1 + w0 * y1 + z0 * x1 - x0 * z1;\n    dst[dstOffset + 2] = z0 * w1 + w0 * z1 + x0 * y1 - y0 * x1;\n    dst[dstOffset + 3] = w0 * w1 - x0 * x1 - y0 * y1 - z0 * z1;\n    return dst;\n  }\n\n  get x() {\n    return this._x;\n  }\n\n  set x(value) {\n    this._x = value;\n\n    this._onChangeCallback();\n  }\n\n  get y() {\n    return this._y;\n  }\n\n  set y(value) {\n    this._y = value;\n\n    this._onChangeCallback();\n  }\n\n  get z() {\n    return this._z;\n  }\n\n  set z(value) {\n    this._z = value;\n\n    this._onChangeCallback();\n  }\n\n  get w() {\n    return this._w;\n  }\n\n  set w(value) {\n    this._w = value;\n\n    this._onChangeCallback();\n  }\n\n  set(x, y, z, w) {\n    this._x = x;\n    this._y = y;\n    this._z = z;\n    this._w = w;\n\n    this._onChangeCallback();\n\n    return this;\n  }\n\n  clone() {\n    return new this.constructor(this._x, this._y, this._z, this._w);\n  }\n\n  copy(quaternion) {\n    this._x = quaternion.x;\n    this._y = quaternion.y;\n    this._z = quaternion.z;\n    this._w = quaternion.w;\n\n    this._onChangeCallback();\n\n    return this;\n  }\n\n  setFromEuler(euler, update) {\n    if (!(euler && euler.isEuler)) {\n      throw new Error('THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.');\n    }\n\n    var x = euler._x,\n        y = euler._y,\n        z = euler._z,\n        order = euler._order; // http://www.mathworks.com/matlabcentral/fileexchange/\n    // \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n    //\tcontent/SpinCalc.m\n\n    var cos = Math.cos;\n    var sin = Math.sin;\n    var c1 = cos(x / 2);\n    var c2 = cos(y / 2);\n    var c3 = cos(z / 2);\n    var s1 = sin(x / 2);\n    var s2 = sin(y / 2);\n    var s3 = sin(z / 2);\n\n    switch (order) {\n      case 'XYZ':\n        this._x = s1 * c2 * c3 + c1 * s2 * s3;\n        this._y = c1 * s2 * c3 - s1 * c2 * s3;\n        this._z = c1 * c2 * s3 + s1 * s2 * c3;\n        this._w = c1 * c2 * c3 - s1 * s2 * s3;\n        break;\n\n      case 'YXZ':\n        this._x = s1 * c2 * c3 + c1 * s2 * s3;\n        this._y = c1 * s2 * c3 - s1 * c2 * s3;\n        this._z = c1 * c2 * s3 - s1 * s2 * c3;\n        this._w = c1 * c2 * c3 + s1 * s2 * s3;\n        break;\n\n      case 'ZXY':\n        this._x = s1 * c2 * c3 - c1 * s2 * s3;\n        this._y = c1 * s2 * c3 + s1 * c2 * s3;\n        this._z = c1 * c2 * s3 + s1 * s2 * c3;\n        this._w = c1 * c2 * c3 - s1 * s2 * s3;\n        break;\n\n      case 'ZYX':\n        this._x = s1 * c2 * c3 - c1 * s2 * s3;\n        this._y = c1 * s2 * c3 + s1 * c2 * s3;\n        this._z = c1 * c2 * s3 - s1 * s2 * c3;\n        this._w = c1 * c2 * c3 + s1 * s2 * s3;\n        break;\n\n      case 'YZX':\n        this._x = s1 * c2 * c3 + c1 * s2 * s3;\n        this._y = c1 * s2 * c3 + s1 * c2 * s3;\n        this._z = c1 * c2 * s3 - s1 * s2 * c3;\n        this._w = c1 * c2 * c3 - s1 * s2 * s3;\n        break;\n\n      case 'XZY':\n        this._x = s1 * c2 * c3 - c1 * s2 * s3;\n        this._y = c1 * s2 * c3 - s1 * c2 * s3;\n        this._z = c1 * c2 * s3 + s1 * s2 * c3;\n        this._w = c1 * c2 * c3 + s1 * s2 * s3;\n        break;\n\n      default:\n        console.warn('THREE.Quaternion: .setFromEuler() encountered an unknown order: ' + order);\n    }\n\n    if (update !== false) this._onChangeCallback();\n    return this;\n  }\n\n  setFromAxisAngle(axis, angle) {\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n    // assumes axis is normalized\n    var halfAngle = angle / 2,\n        s = Math.sin(halfAngle);\n    this._x = axis.x * s;\n    this._y = axis.y * s;\n    this._z = axis.z * s;\n    this._w = Math.cos(halfAngle);\n\n    this._onChangeCallback();\n\n    return this;\n  }\n\n  setFromRotationMatrix(m) {\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n    var te = m.elements,\n        m11 = te[0],\n        m12 = te[4],\n        m13 = te[8],\n        m21 = te[1],\n        m22 = te[5],\n        m23 = te[9],\n        m31 = te[2],\n        m32 = te[6],\n        m33 = te[10],\n        trace = m11 + m22 + m33;\n\n    if (trace > 0) {\n      var s = 0.5 / Math.sqrt(trace + 1.0);\n      this._w = 0.25 / s;\n      this._x = (m32 - m23) * s;\n      this._y = (m13 - m31) * s;\n      this._z = (m21 - m12) * s;\n    } else if (m11 > m22 && m11 > m33) {\n      var _s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\n\n      this._w = (m32 - m23) / _s;\n      this._x = 0.25 * _s;\n      this._y = (m12 + m21) / _s;\n      this._z = (m13 + m31) / _s;\n    } else if (m22 > m33) {\n      var _s2 = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\n\n      this._w = (m13 - m31) / _s2;\n      this._x = (m12 + m21) / _s2;\n      this._y = 0.25 * _s2;\n      this._z = (m23 + m32) / _s2;\n    } else {\n      var _s3 = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\n\n      this._w = (m21 - m12) / _s3;\n      this._x = (m13 + m31) / _s3;\n      this._y = (m23 + m32) / _s3;\n      this._z = 0.25 * _s3;\n    }\n\n    this._onChangeCallback();\n\n    return this;\n  }\n\n  setFromUnitVectors(vFrom, vTo) {\n    // assumes direction vectors vFrom and vTo are normalized\n    var EPS = 0.000001;\n    var r = vFrom.dot(vTo) + 1;\n\n    if (r < EPS) {\n      r = 0;\n\n      if (Math.abs(vFrom.x) > Math.abs(vFrom.z)) {\n        this._x = -vFrom.y;\n        this._y = vFrom.x;\n        this._z = 0;\n        this._w = r;\n      } else {\n        this._x = 0;\n        this._y = -vFrom.z;\n        this._z = vFrom.y;\n        this._w = r;\n      }\n    } else {\n      // crossVectors( vFrom, vTo ); // inlined to avoid cyclic dependency on Vector3\n      this._x = vFrom.y * vTo.z - vFrom.z * vTo.y;\n      this._y = vFrom.z * vTo.x - vFrom.x * vTo.z;\n      this._z = vFrom.x * vTo.y - vFrom.y * vTo.x;\n      this._w = r;\n    }\n\n    return this.normalize();\n  }\n\n  angleTo(q) {\n    return 2 * Math.acos(Math.abs(MathUtils.clamp(this.dot(q), -1, 1)));\n  }\n\n  rotateTowards(q, step) {\n    var angle = this.angleTo(q);\n    if (angle === 0) return this;\n    var t = Math.min(1, step / angle);\n    this.slerp(q, t);\n    return this;\n  }\n\n  identity() {\n    return this.set(0, 0, 0, 1);\n  }\n\n  inverse() {\n    // quaternion is assumed to have unit length\n    return this.conjugate();\n  }\n\n  conjugate() {\n    this._x *= -1;\n    this._y *= -1;\n    this._z *= -1;\n\n    this._onChangeCallback();\n\n    return this;\n  }\n\n  dot(v) {\n    return this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\n  }\n\n  lengthSq() {\n    return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\n  }\n\n  length() {\n    return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w);\n  }\n\n  normalize() {\n    var l = this.length();\n\n    if (l === 0) {\n      this._x = 0;\n      this._y = 0;\n      this._z = 0;\n      this._w = 1;\n    } else {\n      l = 1 / l;\n      this._x = this._x * l;\n      this._y = this._y * l;\n      this._z = this._z * l;\n      this._w = this._w * l;\n    }\n\n    this._onChangeCallback();\n\n    return this;\n  }\n\n  multiply(q, p) {\n    if (p !== undefined) {\n      console.warn('THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.');\n      return this.multiplyQuaternions(q, p);\n    }\n\n    return this.multiplyQuaternions(this, q);\n  }\n\n  premultiply(q) {\n    return this.multiplyQuaternions(q, this);\n  }\n\n  multiplyQuaternions(a, b) {\n    // from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n    var qax = a._x,\n        qay = a._y,\n        qaz = a._z,\n        qaw = a._w;\n    var qbx = b._x,\n        qby = b._y,\n        qbz = b._z,\n        qbw = b._w;\n    this._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n    this._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n    this._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n    this._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n    this._onChangeCallback();\n\n    return this;\n  }\n\n  slerp(qb, t) {\n    if (t === 0) return this;\n    if (t === 1) return this.copy(qb);\n    var x = this._x,\n        y = this._y,\n        z = this._z,\n        w = this._w; // http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n    var cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\n\n    if (cosHalfTheta < 0) {\n      this._w = -qb._w;\n      this._x = -qb._x;\n      this._y = -qb._y;\n      this._z = -qb._z;\n      cosHalfTheta = -cosHalfTheta;\n    } else {\n      this.copy(qb);\n    }\n\n    if (cosHalfTheta >= 1.0) {\n      this._w = w;\n      this._x = x;\n      this._y = y;\n      this._z = z;\n      return this;\n    }\n\n    var sqrSinHalfTheta = 1.0 - cosHalfTheta * cosHalfTheta;\n\n    if (sqrSinHalfTheta <= Number.EPSILON) {\n      var s = 1 - t;\n      this._w = s * w + t * this._w;\n      this._x = s * x + t * this._x;\n      this._y = s * y + t * this._y;\n      this._z = s * z + t * this._z;\n      this.normalize();\n\n      this._onChangeCallback();\n\n      return this;\n    }\n\n    var sinHalfTheta = Math.sqrt(sqrSinHalfTheta);\n    var halfTheta = Math.atan2(sinHalfTheta, cosHalfTheta);\n    var ratioA = Math.sin((1 - t) * halfTheta) / sinHalfTheta,\n        ratioB = Math.sin(t * halfTheta) / sinHalfTheta;\n    this._w = w * ratioA + this._w * ratioB;\n    this._x = x * ratioA + this._x * ratioB;\n    this._y = y * ratioA + this._y * ratioB;\n    this._z = z * ratioA + this._z * ratioB;\n\n    this._onChangeCallback();\n\n    return this;\n  }\n\n  equals(quaternion) {\n    return quaternion._x === this._x && quaternion._y === this._y && quaternion._z === this._z && quaternion._w === this._w;\n  }\n\n  fromArray(array, offset) {\n    if (offset === undefined) offset = 0;\n    this._x = array[offset];\n    this._y = array[offset + 1];\n    this._z = array[offset + 2];\n    this._w = array[offset + 3];\n\n    this._onChangeCallback();\n\n    return this;\n  }\n\n  toArray(array, offset) {\n    if (array === undefined) array = [];\n    if (offset === undefined) offset = 0;\n    array[offset] = this._x;\n    array[offset + 1] = this._y;\n    array[offset + 2] = this._z;\n    array[offset + 3] = this._w;\n    return array;\n  }\n\n  fromBufferAttribute(attribute, index) {\n    this._x = attribute.getX(index);\n    this._y = attribute.getY(index);\n    this._z = attribute.getZ(index);\n    this._w = attribute.getW(index);\n    return this;\n  }\n\n  _onChange(callback) {\n    this._onChangeCallback = callback;\n    return this;\n  }\n\n  _onChangeCallback() {}\n\n}\n\nexport { Quaternion };","map":{"version":3,"sources":["/Users/sebringrose/Projects/theEmpire/website/client/node_modules/three/src/math/Quaternion.js"],"names":["MathUtils","Quaternion","constructor","x","y","z","w","Object","defineProperty","value","_x","_y","_z","_w","slerp","qa","qb","qm","t","copy","slerpFlat","dst","dstOffset","src0","srcOffset0","src1","srcOffset1","x0","y0","z0","w0","x1","y1","z1","w1","s","cos","dir","sqrSin","Number","EPSILON","sin","Math","sqrt","len","atan2","tDir","f","multiplyQuaternionsFlat","_onChangeCallback","set","clone","quaternion","setFromEuler","euler","update","isEuler","Error","order","_order","c1","c2","c3","s1","s2","s3","console","warn","setFromAxisAngle","axis","angle","halfAngle","setFromRotationMatrix","m","te","elements","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","setFromUnitVectors","vFrom","vTo","EPS","r","dot","abs","normalize","angleTo","q","acos","clamp","rotateTowards","step","min","identity","inverse","conjugate","v","lengthSq","length","l","multiply","p","undefined","multiplyQuaternions","premultiply","a","b","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","cosHalfTheta","sqrSinHalfTheta","sinHalfTheta","halfTheta","ratioA","ratioB","equals","fromArray","array","offset","toArray","fromBufferAttribute","attribute","index","getX","getY","getZ","getW","_onChange","callback"],"mappings":"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","sourcesContent":["import { MathUtils } from './MathUtils.js';\n\nclass Quaternion {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tObject.defineProperty( this, 'isQuaternion', { value: true } );\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t}\n\n\tstatic slerp( qa, qb, qm, t ) {\n\n\t\treturn qm.copy( qa ).slerp( qb, t );\n\n\t}\n\n\tstatic slerpFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\n\n\t\t// fuzz-free, array-based Quaternion SLERP operation\n\n\t\tlet x0 = src0[ srcOffset0 + 0 ],\n\t\t\ty0 = src0[ srcOffset0 + 1 ],\n\t\t\tz0 = src0[ srcOffset0 + 2 ],\n\t\t\tw0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 + 0 ],\n\t\t\ty1 = src1[ srcOffset1 + 1 ],\n\t\t\tz1 = src1[ srcOffset1 + 2 ],\n\t\t\tw1 = src1[ srcOffset1 + 3 ];\n\n\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\n\n\t\t\tlet s = 1 - t;\n\t\t\tconst cos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\n\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\n\t\t\t\tsqrSin = 1 - cos * cos;\n\n\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\n\t\t\tif ( sqrSin > Number.EPSILON ) {\n\n\t\t\t\tconst sin = Math.sqrt( sqrSin ),\n\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\n\n\t\t\t\ts = Math.sin( s * len ) / sin;\n\t\t\t\tt = Math.sin( t * len ) / sin;\n\n\t\t\t}\n\n\t\t\tconst tDir = t * dir;\n\n\t\t\tx0 = x0 * s + x1 * tDir;\n\t\t\ty0 = y0 * s + y1 * tDir;\n\t\t\tz0 = z0 * s + z1 * tDir;\n\t\t\tw0 = w0 * s + w1 * tDir;\n\n\t\t\t// Normalize in case we just did a lerp:\n\t\t\tif ( s === 1 - t ) {\n\n\t\t\t\tconst f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\n\n\t\t\t\tx0 *= f;\n\t\t\t\ty0 *= f;\n\t\t\t\tz0 *= f;\n\t\t\t\tw0 *= f;\n\n\t\t\t}\n\n\t\t}\n\n\t\tdst[ dstOffset ] = x0;\n\t\tdst[ dstOffset + 1 ] = y0;\n\t\tdst[ dstOffset + 2 ] = z0;\n\t\tdst[ dstOffset + 3 ] = w0;\n\n\t}\n\n\tstatic multiplyQuaternionsFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1 ) {\n\n\t\tconst x0 = src0[ srcOffset0 ];\n\t\tconst y0 = src0[ srcOffset0 + 1 ];\n\t\tconst z0 = src0[ srcOffset0 + 2 ];\n\t\tconst w0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 ];\n\t\tconst y1 = src1[ srcOffset1 + 1 ];\n\t\tconst z1 = src1[ srcOffset1 + 2 ];\n\t\tconst w1 = src1[ srcOffset1 + 3 ];\n\n\t\tdst[ dstOffset ] = x0 * w1 + w0 * x1 + y0 * z1 - z0 * y1;\n\t\tdst[ dstOffset + 1 ] = y0 * w1 + w0 * y1 + z0 * x1 - x0 * z1;\n\t\tdst[ dstOffset + 2 ] = z0 * w1 + w0 * z1 + x0 * y1 - y0 * x1;\n\t\tdst[ dstOffset + 3 ] = w0 * w1 - x0 * x1 - y0 * y1 - z0 * z1;\n\n\t\treturn dst;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget w() {\n\n\t\treturn this._w;\n\n\t}\n\n\tset w( value ) {\n\n\t\tthis._w = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\n\n\t}\n\n\tcopy( quaternion ) {\n\n\t\tthis._x = quaternion.x;\n\t\tthis._y = quaternion.y;\n\t\tthis._z = quaternion.z;\n\t\tthis._w = quaternion.w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromEuler( euler, update ) {\n\n\t\tif ( ! ( euler && euler.isEuler ) ) {\n\n\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\tconst x = euler._x, y = euler._y, z = euler._z, order = euler._order;\n\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n\t\t//\tcontent/SpinCalc.m\n\n\t\tconst cos = Math.cos;\n\t\tconst sin = Math.sin;\n\n\t\tconst c1 = cos( x / 2 );\n\t\tconst c2 = cos( y / 2 );\n\t\tconst c3 = cos( z / 2 );\n\n\t\tconst s1 = sin( x / 2 );\n\t\tconst s2 = sin( y / 2 );\n\t\tconst s3 = sin( z / 2 );\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.Quaternion: .setFromEuler() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tif ( update !== false ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAxisAngle( axis, angle ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n\n\t\t// assumes axis is normalized\n\n\t\tconst halfAngle = angle / 2, s = Math.sin( halfAngle );\n\n\t\tthis._x = axis.x * s;\n\t\tthis._y = axis.y * s;\n\t\tthis._z = axis.z * s;\n\t\tthis._w = Math.cos( halfAngle );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\n\n\t\t\ttrace = m11 + m22 + m33;\n\n\t\tif ( trace > 0 ) {\n\n\t\t\tconst s = 0.5 / Math.sqrt( trace + 1.0 );\n\n\t\t\tthis._w = 0.25 / s;\n\t\t\tthis._x = ( m32 - m23 ) * s;\n\t\t\tthis._y = ( m13 - m31 ) * s;\n\t\t\tthis._z = ( m21 - m12 ) * s;\n\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\n\n\t\t\tthis._w = ( m32 - m23 ) / s;\n\t\t\tthis._x = 0.25 * s;\n\t\t\tthis._y = ( m12 + m21 ) / s;\n\t\t\tthis._z = ( m13 + m31 ) / s;\n\n\t\t} else if ( m22 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\n\n\t\t\tthis._w = ( m13 - m31 ) / s;\n\t\t\tthis._x = ( m12 + m21 ) / s;\n\t\t\tthis._y = 0.25 * s;\n\t\t\tthis._z = ( m23 + m32 ) / s;\n\n\t\t} else {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\n\n\t\t\tthis._w = ( m21 - m12 ) / s;\n\t\t\tthis._x = ( m13 + m31 ) / s;\n\t\t\tthis._y = ( m23 + m32 ) / s;\n\t\t\tthis._z = 0.25 * s;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromUnitVectors( vFrom, vTo ) {\n\n\t\t// assumes direction vectors vFrom and vTo are normalized\n\n\t\tconst EPS = 0.000001;\n\n\t\tlet r = vFrom.dot( vTo ) + 1;\n\n\t\tif ( r < EPS ) {\n\n\t\t\tr = 0;\n\n\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\n\n\t\t\t\tthis._x = - vFrom.y;\n\t\t\t\tthis._y = vFrom.x;\n\t\t\t\tthis._z = 0;\n\t\t\t\tthis._w = r;\n\n\t\t\t} else {\n\n\t\t\t\tthis._x = 0;\n\t\t\t\tthis._y = - vFrom.z;\n\t\t\t\tthis._z = vFrom.y;\n\t\t\t\tthis._w = r;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// crossVectors( vFrom, vTo ); // inlined to avoid cyclic dependency on Vector3\n\n\t\t\tthis._x = vFrom.y * vTo.z - vFrom.z * vTo.y;\n\t\t\tthis._y = vFrom.z * vTo.x - vFrom.x * vTo.z;\n\t\t\tthis._z = vFrom.x * vTo.y - vFrom.y * vTo.x;\n\t\t\tthis._w = r;\n\n\t\t}\n\n\t\treturn this.normalize();\n\n\t}\n\n\tangleTo( q ) {\n\n\t\treturn 2 * Math.acos( Math.abs( MathUtils.clamp( this.dot( q ), - 1, 1 ) ) );\n\n\t}\n\n\trotateTowards( q, step ) {\n\n\t\tconst angle = this.angleTo( q );\n\n\t\tif ( angle === 0 ) return this;\n\n\t\tconst t = Math.min( 1, step / angle );\n\n\t\tthis.slerp( q, t );\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\treturn this.set( 0, 0, 0, 1 );\n\n\t}\n\n\tinverse() {\n\n\t\t// quaternion is assumed to have unit length\n\n\t\treturn this.conjugate();\n\n\t}\n\n\tconjugate() {\n\n\t\tthis._x *= - 1;\n\t\tthis._y *= - 1;\n\t\tthis._z *= - 1;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\n\n\t}\n\n\tnormalize() {\n\n\t\tlet l = this.length();\n\n\t\tif ( l === 0 ) {\n\n\t\t\tthis._x = 0;\n\t\t\tthis._y = 0;\n\t\t\tthis._z = 0;\n\t\t\tthis._w = 1;\n\n\t\t} else {\n\n\t\t\tl = 1 / l;\n\n\t\t\tthis._x = this._x * l;\n\t\t\tthis._y = this._y * l;\n\t\t\tthis._z = this._z * l;\n\t\t\tthis._w = this._w * l;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( q, p ) {\n\n\t\tif ( p !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\n\t\t\treturn this.multiplyQuaternions( q, p );\n\n\t\t}\n\n\t\treturn this.multiplyQuaternions( this, q );\n\n\t}\n\n\tpremultiply( q ) {\n\n\t\treturn this.multiplyQuaternions( q, this );\n\n\t}\n\n\tmultiplyQuaternions( a, b ) {\n\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\n\t\tconst qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\n\t\tconst qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\n\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerp( qb, t ) {\n\n\t\tif ( t === 0 ) return this;\n\t\tif ( t === 1 ) return this.copy( qb );\n\n\t\tconst x = this._x, y = this._y, z = this._z, w = this._w;\n\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n\t\tlet cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\n\n\t\tif ( cosHalfTheta < 0 ) {\n\n\t\t\tthis._w = - qb._w;\n\t\t\tthis._x = - qb._x;\n\t\t\tthis._y = - qb._y;\n\t\t\tthis._z = - qb._z;\n\n\t\t\tcosHalfTheta = - cosHalfTheta;\n\n\t\t} else {\n\n\t\t\tthis.copy( qb );\n\n\t\t}\n\n\t\tif ( cosHalfTheta >= 1.0 ) {\n\n\t\t\tthis._w = w;\n\t\t\tthis._x = x;\n\t\t\tthis._y = y;\n\t\t\tthis._z = z;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sqrSinHalfTheta = 1.0 - cosHalfTheta * cosHalfTheta;\n\n\t\tif ( sqrSinHalfTheta <= Number.EPSILON ) {\n\n\t\t\tconst s = 1 - t;\n\t\t\tthis._w = s * w + t * this._w;\n\t\t\tthis._x = s * x + t * this._x;\n\t\t\tthis._y = s * y + t * this._y;\n\t\t\tthis._z = s * z + t * this._z;\n\n\t\t\tthis.normalize();\n\t\t\tthis._onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sinHalfTheta = Math.sqrt( sqrSinHalfTheta );\n\t\tconst halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\n\t\tconst ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\n\t\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\n\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tequals( quaternion ) {\n\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\n\n\t}\n\n\tfromArray( array, offset ) {\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tthis._x = array[ offset ];\n\t\tthis._y = array[ offset + 1 ];\n\t\tthis._z = array[ offset + 2 ];\n\t\tthis._w = array[ offset + 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array, offset ) {\n\n\t\tif ( array === undefined ) array = [];\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis._x = attribute.getX( index );\n\t\tthis._y = attribute.getY( index );\n\t\tthis._z = attribute.getZ( index );\n\t\tthis._w = attribute.getW( index );\n\n\t\treturn this;\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n}\n\n\nexport { Quaternion };\n"]},"metadata":{},"sourceType":"module"}
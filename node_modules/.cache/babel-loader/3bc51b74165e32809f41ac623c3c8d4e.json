{"ast":null,"code":"function WebGLAttributes(gl, capabilities) {\n  var isWebGL2 = capabilities.isWebGL2;\n  var buffers = new WeakMap();\n\n  function createBuffer(attribute, bufferType) {\n    var array = attribute.array;\n    var usage = attribute.usage;\n    var buffer = gl.createBuffer();\n    gl.bindBuffer(bufferType, buffer);\n    gl.bufferData(bufferType, array, usage);\n    attribute.onUploadCallback();\n    var type = gl.FLOAT;\n\n    if (array instanceof Float32Array) {\n      type = gl.FLOAT;\n    } else if (array instanceof Float64Array) {\n      console.warn('THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.');\n    } else if (array instanceof Uint16Array) {\n      type = gl.UNSIGNED_SHORT;\n    } else if (array instanceof Int16Array) {\n      type = gl.SHORT;\n    } else if (array instanceof Uint32Array) {\n      type = gl.UNSIGNED_INT;\n    } else if (array instanceof Int32Array) {\n      type = gl.INT;\n    } else if (array instanceof Int8Array) {\n      type = gl.BYTE;\n    } else if (array instanceof Uint8Array) {\n      type = gl.UNSIGNED_BYTE;\n    }\n\n    return {\n      buffer: buffer,\n      type: type,\n      bytesPerElement: array.BYTES_PER_ELEMENT,\n      version: attribute.version\n    };\n  }\n\n  function updateBuffer(buffer, attribute, bufferType) {\n    var array = attribute.array;\n    var updateRange = attribute.updateRange;\n    gl.bindBuffer(bufferType, buffer);\n\n    if (updateRange.count === -1) {\n      // Not using update ranges\n      gl.bufferSubData(bufferType, 0, array);\n    } else {\n      if (isWebGL2) {\n        gl.bufferSubData(bufferType, updateRange.offset * array.BYTES_PER_ELEMENT, array, updateRange.offset, updateRange.count);\n      } else {\n        gl.bufferSubData(bufferType, updateRange.offset * array.BYTES_PER_ELEMENT, array.subarray(updateRange.offset, updateRange.offset + updateRange.count));\n      }\n\n      updateRange.count = -1; // reset range\n    }\n  } //\n\n\n  function get(attribute) {\n    if (attribute.isInterleavedBufferAttribute) attribute = attribute.data;\n    return buffers.get(attribute);\n  }\n\n  function remove(attribute) {\n    if (attribute.isInterleavedBufferAttribute) attribute = attribute.data;\n    var data = buffers.get(attribute);\n\n    if (data) {\n      gl.deleteBuffer(data.buffer);\n      buffers.delete(attribute);\n    }\n  }\n\n  function update(attribute, bufferType) {\n    if (attribute.isGLBufferAttribute) {\n      var cached = buffers.get(attribute);\n\n      if (!cached || cached.version < attribute.version) {\n        buffers.set(attribute, {\n          buffer: attribute.buffer,\n          type: attribute.type,\n          bytesPerElement: attribute.elementSize,\n          version: attribute.version\n        });\n      }\n\n      return;\n    }\n\n    if (attribute.isInterleavedBufferAttribute) attribute = attribute.data;\n    var data = buffers.get(attribute);\n\n    if (data === undefined) {\n      buffers.set(attribute, createBuffer(attribute, bufferType));\n    } else if (data.version < attribute.version) {\n      updateBuffer(data.buffer, attribute, bufferType);\n      data.version = attribute.version;\n    }\n  }\n\n  return {\n    get: get,\n    remove: remove,\n    update: update\n  };\n}\n\nexport { WebGLAttributes };","map":{"version":3,"sources":["/Users/sebringrose/Projects/theEmpire/website/client/node_modules/three/src/renderers/webgl/WebGLAttributes.js"],"names":["WebGLAttributes","gl","capabilities","isWebGL2","buffers","WeakMap","createBuffer","attribute","bufferType","array","usage","buffer","bindBuffer","bufferData","onUploadCallback","type","FLOAT","Float32Array","Float64Array","console","warn","Uint16Array","UNSIGNED_SHORT","Int16Array","SHORT","Uint32Array","UNSIGNED_INT","Int32Array","INT","Int8Array","BYTE","Uint8Array","UNSIGNED_BYTE","bytesPerElement","BYTES_PER_ELEMENT","version","updateBuffer","updateRange","count","bufferSubData","offset","subarray","get","isInterleavedBufferAttribute","data","remove","deleteBuffer","delete","update","isGLBufferAttribute","cached","set","elementSize","undefined"],"mappings":"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","sourcesContent":["function WebGLAttributes( gl, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tconst buffers = new WeakMap();\n\n\tfunction createBuffer( attribute, bufferType ) {\n\n\t\tconst array = attribute.array;\n\t\tconst usage = attribute.usage;\n\n\t\tconst buffer = gl.createBuffer();\n\n\t\tgl.bindBuffer( bufferType, buffer );\n\t\tgl.bufferData( bufferType, array, usage );\n\n\t\tattribute.onUploadCallback();\n\n\t\tlet type = gl.FLOAT;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\ttype = gl.FLOAT;\n\n\t\t} else if ( array instanceof Float64Array ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.' );\n\n\t\t} else if ( array instanceof Uint16Array ) {\n\n\t\t\ttype = gl.UNSIGNED_SHORT;\n\n\t\t} else if ( array instanceof Int16Array ) {\n\n\t\t\ttype = gl.SHORT;\n\n\t\t} else if ( array instanceof Uint32Array ) {\n\n\t\t\ttype = gl.UNSIGNED_INT;\n\n\t\t} else if ( array instanceof Int32Array ) {\n\n\t\t\ttype = gl.INT;\n\n\t\t} else if ( array instanceof Int8Array ) {\n\n\t\t\ttype = gl.BYTE;\n\n\t\t} else if ( array instanceof Uint8Array ) {\n\n\t\t\ttype = gl.UNSIGNED_BYTE;\n\n\t\t}\n\n\t\treturn {\n\t\t\tbuffer: buffer,\n\t\t\ttype: type,\n\t\t\tbytesPerElement: array.BYTES_PER_ELEMENT,\n\t\t\tversion: attribute.version\n\t\t};\n\n\t}\n\n\tfunction updateBuffer( buffer, attribute, bufferType ) {\n\n\t\tconst array = attribute.array;\n\t\tconst updateRange = attribute.updateRange;\n\n\t\tgl.bindBuffer( bufferType, buffer );\n\n\t\tif ( updateRange.count === - 1 ) {\n\n\t\t\t// Not using update ranges\n\n\t\t\tgl.bufferSubData( bufferType, 0, array );\n\n\t\t} else {\n\n\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\tgl.bufferSubData( bufferType, updateRange.offset * array.BYTES_PER_ELEMENT,\n\t\t\t\t\tarray, updateRange.offset, updateRange.count );\n\n\t\t\t} else {\n\n\t\t\t\tgl.bufferSubData( bufferType, updateRange.offset * array.BYTES_PER_ELEMENT,\n\t\t\t\t\tarray.subarray( updateRange.offset, updateRange.offset + updateRange.count ) );\n\n\t\t\t}\n\n\t\t\tupdateRange.count = - 1; // reset range\n\n\t\t}\n\n\t}\n\n\t//\n\n\tfunction get( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\treturn buffers.get( attribute );\n\n\t}\n\n\tfunction remove( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\tconst data = buffers.get( attribute );\n\n\t\tif ( data ) {\n\n\t\t\tgl.deleteBuffer( data.buffer );\n\n\t\t\tbuffers.delete( attribute );\n\n\t\t}\n\n\t}\n\n\tfunction update( attribute, bufferType ) {\n\n\t\tif ( attribute.isGLBufferAttribute ) {\n\n\t\t\tvar cached = buffers.get( attribute );\n\n\t\t\tif ( ! cached || cached.version < attribute.version ) {\n\n\t\t\t\tbuffers.set( attribute, {\n\t\t\t\t\tbuffer: attribute.buffer,\n\t\t\t\t\ttype: attribute.type,\n\t\t\t\t\tbytesPerElement: attribute.elementSize,\n\t\t\t\t\tversion: attribute.version\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\tconst data = buffers.get( attribute );\n\n\t\tif ( data === undefined ) {\n\n\t\t\tbuffers.set( attribute, createBuffer( attribute, bufferType ) );\n\n\t\t} else if ( data.version < attribute.version ) {\n\n\t\t\tupdateBuffer( data.buffer, attribute, bufferType );\n\n\t\t\tdata.version = attribute.version;\n\n\t\t}\n\n\t}\n\n\treturn {\n\n\t\tget: get,\n\t\tremove: remove,\n\t\tupdate: update\n\n\t};\n\n}\n\n\nexport { WebGLAttributes };\n"]},"metadata":{},"sourceType":"module"}